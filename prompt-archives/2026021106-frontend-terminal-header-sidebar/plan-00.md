# Plan 00：前端终端页顶栏、标题与 Sidebar 三层高亮改造

时间：2026-02-11

## 背景

当前终端页在移动端与桌面端存在以下问题：
1. 三处头部（移动端全局顶栏、PC 主内容顶栏、PC Sidebar 顶栏）高度不一致。
2. 浏览器标题与页面顶部缺少统一的终端上下文信息。
3. 操作按钮“同步尺寸”与当前交互目标不一致，需要改为“跳转到最新”。
4. 编辑器切换仅移动端可用，PC 无法切换。
5. Sidebar 高亮缺乏设备→窗口→pane 的层级语义。

## 注意事项

1. 本轮仅修改前端（`apps/fe`），不改网关协议与共享类型。
2. 统一高度按已确认决策固定为 `44px`。
3. 顶部上下文文案按已确认格式：`Pane {paneIdx}/{windowIdx}: {windowName}@{deviceName}`。
4. `deviceName` 使用设备 `name`，缺失回退 `id`。
5. Sidebar 折叠态仅保留设备层 15% 高亮。
6. 需同步更新现有 e2e 中“同步尺寸”相关断言。

## 目标

1. 三处头部统一为 44px。
2. 终端页移动/PC 顶栏显示同一上下文文案。
3. 浏览器标题在终端页显示 `[tmex]${label}`，非终端页恢复 `tmex`。
4. 移除“同步尺寸”，新增“跳转到最新”。
5. PC 上可切换“编辑器/直接输入”，并可使用编辑器发送。
6. Sidebar 实现三层透明叠加高亮。
7. 相关 e2e 通过。

## 任务清单

1. 新增终端上下文格式化工具，统一 label/title 生成。
2. 修改 `RootLayout`：移动端顶栏高度与终端上下文展示。
3. 修改 `DevicePage`：PC 顶栏信息、浏览器标题、按钮替换、PC 编辑器切换。
4. 修改 `Sidebar`：设备/窗口/pane 三层高亮与折叠态规则。
5. 更新 e2e：终端标题、按钮文案、禁用态、移动端顶栏文案、Sidebar 层级高亮验证。
6. 运行定向 e2e 与构建验证。

## 验收标准

1. 移动端终端页顶部可见汉堡按钮，中心文案显示 `Pane ...@...`。
2. PC 终端页右侧顶部文案与移动端一致。
3. 页面标题在终端态为 `[tmex]Pane ...@...`，离开终端页恢复 `tmex`。
4. 页面中不再出现“同步尺寸”按钮，仅有“跳转到最新”按钮。
5. PC 点击“编辑器”后出现编辑器输入区并可发送。
6. Sidebar：device 15%、window 再叠 15%、pane 90%。
7. 定向 e2e 全部通过。
